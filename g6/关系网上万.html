<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style lang="">
    body {
      width: 100%;
      height: 100%
    }

    #container {
      width: 100vw;
      height: 100vh;
    }
  </style>
</head>

<body>
  <div id="container"></div>
  <script src="https://gw.alipayobjects.com/os/lib/antv/g6/4.3.11/dist/g6.min.js"></script>
  <script>

    const container = document.getElementById('container');
    const width = container.scrollWidth;
    const height = container.scrollHeight || 500;
    const graph = new G6.Graph({
      container: 'container',
      width,
      height,
      modes: {
        default: ['zoom-canvas', 'drag-canvas', 'drag-node'],
      },
      layout: {
        type: 'force',
        workerEnabled: true, // 开启 Web-Worker
        // preventOverlap: true,
        // kr: 10,
        // center: [250, 250],
        // type: 'random',
        preventOverlap: true,
        // collideStrength:0.3,
        // alphaMin:0.01,
        // nodeSize:20,
        // nodeSpacing:4,
        // workerEnabled:true,
        // center: [200, 200],     // 可选，默认为图的中心
        // linkDistance: 50,         // 可选，边长
        // nodeStrength: 30,         // 可选
        // edgeStrength: 0.1,        // 可选
        // collideStrength: 0.8,     // 可选
        // nodeSize: 30,             // 可选
        // alpha: 0.3,               // 可选
        // alphaDecay: 0.028,        // 可选
        // alphaMin: 0.01,           // 可选
        // forceSimulation: null,    // 可选
      },
      defaultNode: {
        type: 'image',
        size: 10,
        img: 'https://yyb.gtimg.com/aiplat/page/product/visionimgidy/img/demo6-16a47e5d31.jpg?max_age=31536000',
        clipCfg: {
          show: true,
          type: 'circle',
          r: 10,
        }

      },
    });


    let nodes = [], edges = []
    const centerX = 284.686, centerY = 253.505
    const size = 10

    // const getMaxCircular = (r, R) => {
    //   const pi = 3.1416
    //   const circulaArea=pi* Math.pow(size/2, 2)
    //   const ringArea =pi*(Math.pow(R,2)- Math.pow(r, 2))
    //   return parseInt(ringArea/ circulaArea)
    // }

    // const helper=(num, r, R )=>{

    //   const layerTotle= getMaxCircular(r,R)
    //   const surplusNum= num - layerTotle
    //   if(surplusNum>0){
    //     helper(surplusNum, R, R + size)
    //   }
    // }

    // helper(300, size/2, (size / 2)+size)


    for (let i = 1; i < 2000; i++) {
      // const obj = { data: { id: 'n' + i, name: 'duuliy' + i } }
      // const obj2 = { data: { id: 'e' + i + 27, relationship: '秘密关系', source: 'n2', target: 'n' + i + 28 } }
      const obj = { id: i + '', x: centerX + i * 10, y: centerY + i * 10 }
      const obj2 = { "source": '1', "target": i + 1 + '', "value": 1 }
      nodes.push(obj)
      edges.push(obj2)
    }
    // fetch('https://gw.alipayobjects.com/os/antvdemo/assets/data/relations.json')
    //   .then((res) => {
    //     console.log(res.body)
    //     return res.json()
    //   })
    //   .then((data) => {
    //     console.log(data)
    //     // data.nodes.forEach(node => {
    //     //   node.x = Math.random() * 1;
    //     // });
    //     // graph.on('afterlayout', e => {
    //     //   graph.fitView()
    //     // })
    //     // graph.data(data);
    //     // graph.render();
    //   });

    const data = {
      nodes,
      edges
    }
    // data.nodes.forEach(node => {
    //   node.x = Math.random() * 1;
    // });
    console.log(data)
    graph.on('afterlayout', e => {
      graph.fitView()
    })
    graph.data(data);
    graph.render();

    if (typeof window !== 'undefined')
      window.onresize = () => {
        if (!graph || graph.get('destroyed')) return;
        if (!container || !container.scrollWidth || !container.scrollHeight) return;
        graph.changeSize(container.scrollWidth, container.scrollHeight);
      };



  </script>
</body>

</html>